<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('../../Include/Head.ejs') %>
</head>
<body class="hold-transition sidebar-mini layout-fixed layout-navbar-fixed layout-footer-fixed">
    
    <!-- Wrapper -->
    <div class="wrapper">

        <!-- Preloader -->
        <%- include('../../Include/Preloader.ejs') %>
        <!-- Preloader End -->

        <!-- Navbar -->
        <%- include('../../Include/Navbar.ejs') %>
        <!-- Navbar End -->

        <!-- Main Sidebar -->
        <%- include('../../Include/Role/Shop_Owner/Shop_Owner_Sidebar.ejs') %>
        <!-- Main Sidebar End -->

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            <!-- Content Header (Page header) -->
            <section class="content-header">
                <div class="container-fluid">
                    <div class="row mb-2">
                        <div class="col-sm-6">
                            <h1>ตั้งค่าระบบร้านค้า</h1>
                        </div>
                        <div class="col-sm-6">
                            <ol class="breadcrumb float-sm-right">
                                <li class="breadcrumb-item"><a class="text-primary" style="cursor: pointer;" onclick="location.href='/';">หน้าหลัก</a></li>
                                <li class="breadcrumb-item active">ตั้งค่าระบบร้านค้า</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </section>
            <!-- Content Header End (Page header) -->
        
            <!-- Main content -->
            <section class="content">
                <div class="container-fluid">
                    <div class="row">
        
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">เวลาจดจำการลงชื่อเข้าใช้</div>
                                <div class="card-body">

                                    <% if (settings_form_0_error) { %>
                                    <div class="alert alert-danger text-center" role="alert">
                                        <span><i class="fas fa-exclamation-triangle mr-2"></i><%= settings_form_0_error %>
                                    </div>
                                    <% } %>
                                    <% if (settings_form_0_success) { %>
                                    <div class="alert alert-success text-center" role="alert">
                                        <span><i class="fas fa-check-circle mr-2"></i><%= settings_form_0_success %>
                                    </div>
                                    <% } %>

                                    <form action="" class="needs-validation" novalidate method="POST">
                                        <div class="form-group row">
                                            <label for="login_time_out" class="col-sm-2 col-form-label required">จดจำการลงชื่อเข้าใช้ :</label>
                                            <div class="col-sm-10">
                                                <select class="form-control form-control-lg login_time_out mb-2" name="login_time_out" id="login_time_out" required>
                                                    <option <%= settings.login_time_out === '3h' ? 'selected' : '' %> value="3h">เวลา 3 ชั่วโมง</option>
                                                    <option <%= settings.login_time_out === '6h' ? 'selected' : '' %> value="6h">เวลา 6 ชั่วโมง</option>
                                                    <option <%= settings.login_time_out === '9h' ? 'selected' : '' %> value="9h">เวลา 9 ชั่วโมง</option>
                                                    <option <%= settings.login_time_out === '12h' ? 'selected' : '' %> value="12h">เวลา 12 ชั่วโมง</option>
                                                    <option <%= settings.login_time_out === '24h' ? 'selected' : '' %> value="24h">เวลา 24 ชั่วโมง</option>
                                                    <option <%= settings.login_time_out === '7d' ? 'selected' : '' %> value="7d">เวลา 7 วัน (แนะนำ)</option>
                                                    <option <%= settings.login_time_out === '30d' ? 'selected' : '' %> value="30d">เวลา 30 วัน</option>
                                                    <option <%= settings.login_time_out === '3m' ? 'selected' : '' %> value="3m">เวลา 3 เดือน</option>
                                                    <option <%= settings.login_time_out === '6m' ? 'selected' : '' %> value="6m">เวลา 6 เดือน</option>
                                                    <option <%= settings.login_time_out === '9m' ? 'selected' : '' %> value="9m">เวลา 9 เดือน</option>
                                                    <option <%= settings.login_time_out === '1y' ? 'selected' : '' %> value="1y">เวลา 1 ปี</option>
                                                </select>
                                                <span class="text-muted">(กรุณาออกจากระบบ แล้วลงชื่อเข้าสู่ระใหม่อีกครั้ง เพื่อให้การเปลี่ยนแปลงนี้มีผล)</span>
                                                <div class="valid-feedback">
                                                    เลือกเลือกเวลาการจดจำถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกเลือกเวลาการจดจำให้ถูกต้อง
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                    <script>
                                        document.addEventListener('DOMContentLoaded', () => {
                                            const Login_Time_Out_Select = document.getElementById('login_time_out');
                                    
                                            function updateSettings() {
                                                const Login_Time_Out = Login_Time_Out_Select.value;
                                    
                                                fetch('/Role/Shop_Owner/Page/System_Settings/Update_Settings_Form_0', {
                                                    method: 'POST',
                                                    headers: {
                                                        'Content-Type': 'application/json',
                                                        'X-Requested-With': 'XMLHttpRequest'
                                                    },
                                                    body: JSON.stringify({
                                                        login_time_out: Login_Time_Out,
                                                    })
                                                })
                                                .then(response => response.json())
                                                .then(data => {
                                                    if (data.success) {
                                                        console.log('Setting updated successfully');
                                                        // Reload the page
                                                        location.reload();
                                                    } else {
                                                        console.error('Failed to update setting');
                                                    }
                                                })
                                                .catch(error => console.error('Error:', error));
                                            }
                                    
                                            function preventEnterKey(event) {
                                                if (event.key === 'Enter') {
                                                    event.preventDefault();
                                                }
                                            }

                                            // ป้องกันการกดปุ่ม Enter
                                            Login_Time_Out_Select.addEventListener('keydown', preventEnterKey);

                                            // ใช้ change event เพื่อ update
                                            Login_Time_Out_Select.addEventListener('change', updateSettings);
                                        });
                                    </script>
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">ส่วนข้อมูลร้านค้า</div>
                                <div class="card-body">

                                    <% if (settings_form_1_error) { %>
                                    <div class="alert alert-danger text-center" role="alert">
                                        <span><i class="fas fa-exclamation-triangle mr-2"></i><%= settings_form_1_error %>
                                    </div>
                                    <% } %>
                                    <% if (settings_form_1_success) { %>
                                    <div class="alert alert-success text-center" role="alert">
                                        <span><i class="fas fa-check-circle mr-2"></i><%= settings_form_1_success %>
                                    </div>
                                    <% } %>

                                    <form action="" method="POST">
                                        <div class="form-group row">
                                            <label for="store_name" class="col-sm-2 col-form-label required">ชื่อร้านค้า :</label>
                                            <div class="col-sm-10">
                                                <input type="text" class="form-control form-control-lg store_name" name="store_name" id="store_name" placeholder="ชื่อร้านค้า" value="<%= settings.store_name %>" required autocomplete="off">
                                                <div class="valid-feedback">
                                                    กรอกชื่อร้านค้าถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณากรอกชื่อร้านค้าให้ถูกต้อง
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="store_description" class="col-sm-2 col-form-label required">คำอธิบายร้านค้า :</label>
                                            <div class="col-sm-10">
                                                <textarea class="form-control form-control-lg store_description" name="store_description" id="store_description" rows="5" placeholder="คำอธิบายร้านค้า" required autocomplete="off"><%= settings.store_description %></textarea>
                                                <div class="valid-feedback">
                                                    กรอกคำอธิบายร้านค้าถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณากรอกคำอธิบายร้านค้าให้ถูกต้อง
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="store_categorie" class="col-sm-2 col-form-label required">ประเภทร้านค้า :</label>
                                            <div class="col-sm-10">
                                                <select class="form-control form-control-lg store_categorie" name="store_categorie" id="store_categorie" required>
                                                    <option value="" selected disabled>เลือกประเภทร้านค้า</option>
                                                    <option <%= settings.store_categorie === 'ร้านค้าปลีก (Retail Store)' ? 'selected' : '' %> value="ร้านค้าปลีก (Retail Store)">ร้านค้าปลีก (Retail Store)</option>
                                                    <option <%= settings.store_categorie === 'ร้านค้าส่ง (Wholesale Store)' ? 'selected' : '' %> value="ร้านค้าส่ง (Wholesale Store)">ร้านค้าส่ง (Wholesale Store)</option>
                                                    <option <%= settings.store_categorie === 'ร้านค้าออนไลน์ (Online Store)' ? 'selected' : '' %> value="ร้านค้าออนไลน์ (Online Store)">ร้านค้าออนไลน์ (Online Store)</option>
                                                    <option <%= settings.store_categorie === 'ร้านอาหารและเครื่องดื่ม (Food and Beverage Store)' ? 'selected' : '' %> value="ร้านอาหารและเครื่องดื่ม (Food and Beverage Store)">ร้านอาหารและเครื่องดื่ม (Food and Beverage Store)</option>
                                                    <option <%= settings.store_categorie === 'ร้านค้าพิเศษ (Specialty Store)' ? 'selected' : '' %> value="ร้านค้าพิเศษ (Specialty Store)">ร้านค้าพิเศษ (Specialty Store)</option>
                                                    <option <%= settings.store_categorie === 'ร้านสะดวกซื้อ (Convenience Store)' ? 'selected' : '' %> value="ร้านสะดวกซื้อ (Convenience Store)">ร้านสะดวกซื้อ (Convenience Store)</option>
                                                    <option <%= settings.store_categorie === 'ร้านค้าชุมชน (Community Store)' ? 'selected' : '' %> value="ร้านค้าชุมชน (Community Store)">ร้านค้าชุมชน (Community Store)</option>
                                                    <option <%= settings.store_categorie === 'ร้านขายสินค้าเฉพาะกิจ (Pop-up Store)' ? 'selected' : '' %> value="ร้านขายสินค้าเฉพาะกิจ (Pop-up Store)">ร้านขายสินค้าเฉพาะกิจ (Pop-up Store)</option>
                                                    <option <%= settings.store_categorie === 'Other' ? 'selected' : '' %> value="Other">อื่น ๆ กำหนดเอง</option>
                                                    <option <%= settings.store_categorie === 'ไม่ระบุ' ? 'selected' : '' %> value="ไม่ระบุ">ไม่ระบุ</option>
                                                </select>
                                                <div class="valid-feedback">
                                                    เลือกประเภทร้านค้าถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกประเภทร้านค้าให้ถูกต้อง
                                                </div>
                                                <div class="btn btn-custom-two btn-lg btn-block mt-3" data-toggle="collapse" data-target="#HelpInformation" aria-expanded="false" aria-controls="HelpInformation"><i class="fas fa-info-circle mr-2"></i>คำแนะนำประเภทร้านค้า (คลิ้ก)</div>
                                                <div class="collapse mt-3" id="HelpInformation">
                                                    <div class="card card-body">
                                                        <ul class="pl-3 pr-3 pt-0 pb-0 m-0">
                                                            <li>
                                                                <b>ร้านค้าปลีก (Retail Store)</b><br>
                                                                <span>ร้านค้าที่จำหน่ายสินค้าให้แก่ผู้บริโภคโดยตรง</span>
                                                            </li>
                                                            <li>
                                                                <b>ร้านค้าส่ง (Wholesale Store)</b><br>
                                                                <span>ร้านค้าที่จำหน่ายสินค้าจำนวนมากให้แก่ร้านค้าปลีกหรือธุรกิจอื่น ๆ</span>
                                                            </li>
                                                            <li>
                                                                <b>ร้านค้าออนไลน์ (Online Store)</b><br>
                                                                <span>ร้านค้าที่จำหน่ายสินค้าและบริการผ่านทางอินเทอร์เน็ต</span>
                                                            </li>
                                                            <li>
                                                                <b>ร้านอาหารและเครื่องดื่ม (Food and Beverage Store)</b><br>
                                                                <span>ร้านค้าที่เน้นการจำหน่ายอาหารและเครื่องดื่ม</span>
                                                            </li>
                                                            <li>
                                                                <b>ร้านค้าพิเศษ (Specialty Store)</b><br>
                                                                <span>ร้านค้าที่จำหน่ายสินค้าประเภทใดประเภทหนึ่งโดยเฉพาะ</span>
                                                            </li>
                                                            <li>
                                                                <b>ร้านสะดวกซื้อ (Convenience Store)</b><br>
                                                                <span>ร้านค้าที่เปิดให้บริการตลอด 24 ชั่วโมง และจำหน่ายสินค้าจำเป็นในชีวิตประจำวัน</span>
                                                            </li>
                                                            <li>
                                                                <b>ร้านค้าชุมชน (Community Store)</b><br>
                                                                <span>ร้านค้าที่เน้นการจำหน่ายสินค้าในชุมชน</span>
                                                            </li>
                                                            <li>
                                                                <b>ร้านขายสินค้าเฉพาะกิจ (Pop-up Store)</b><br>
                                                                <span>ร้านค้าที่เปิดเป็นการชั่วคราวในงานเทศกาลหรืองานอีเวนต์ต่าง ๆ</span>
                                                            </li>
                                                            <li>
                                                                <b>อื่น ๆ กำหนดเอง</b><br>
                                                                <span>กำหนดประเภทร้านค้าด้วยตนเอง</span>
                                                            </li>
                                                            <li>
                                                                <b>ไม่ระบุ</b><br>
                                                                <span>หากยังไม่ต้องการแสดงประเภทร้านค้าในตอนนี้</span>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group row <% if (settings.store_categorie !== 'Other') { %> d-none <% } %>">
                                            <label for="store_categorie_custom" class="col-sm-2 col-form-label required">อื่น ๆ กำหนดเอง :</label>
                                            <div class="col-sm-10">
                                                <input type="text" class="form-control form-control-lg store_categorie_custom" name="store_categorie_custom" id="store_categorie_custom" placeholder="กำหนดประเภทร้านค้าเอง" value="<%= settings.store_categorie_custom %>" required autocomplete="off">
                                                <div class="valid-feedback">
                                                    กรอกประเภทร้านค้าถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณากรอกประเภทร้านค้าให้ถูกต้อง
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                    <script>
                                        document.addEventListener('DOMContentLoaded', () => {
                                            const Store_Name_Input = document.getElementById('store_name');
                                            const Store_Description_Input = document.getElementById('store_description');
                                            const Store_Categorie_Select = document.getElementById('store_categorie');
                                            const Store_Categorie_Custom_Input = document.getElementById('store_categorie_custom');

                                            var ConfirmButton = function(context) {
                                                var ui = $.summernote.ui;
                                                var button = ui.button({
                                                    contents: '<i class="fas fa-save mr-1"></i>บันทึกข้อมูล',
                                                    tooltip: 'Save to Database',
                                                    click: function() {
                                                        console.log('Confirm button clicked');
                                                        updateSettings();
                                                    }
                                                });
                                                return button.render();
                                            };

                                            $('.store_description').summernote({
                                                disableDragAndDrop: true,
                                                inheritPlaceholder: true,
                                                tabsize: 2,
                                                height: 300,
                                                fontNames: ['Bai Jamjuree'],
                                                fontNamesIgnoreCheck: ['Bai Jamjuree'],
                                                toolbar: [
                                                    ['style', ['style']],
                                                    ['font', ['bold', 'italic', 'underline', 'strikethrough', 'clear']],
                                                    ['color', ['color']],
                                                    ['para', ['ul', 'ol', 'paragraph', 'height']],
                                                    ['insert', ['link', 'hr']],
                                                    ['view_and_save', ['fullscreen', 'codeview', 'undo', 'redo', 'confirm']]
                                                ],
                                                buttons: {
                                                    confirm: ConfirmButton
                                                },
                                                popover: {
                                                    link: [
                                                        ['link', ['linkDialogShow', 'unlink']]
                                                    ]
                                                }
                                            });

                                            function updateSettings() {
                                                const Store_Name = Store_Name_Input.value;
                                                const Store_Description = $('#store_description').summernote('code');
                                                let Store_Categorie = Store_Categorie_Select.value;
                                                let Store_Categorie_Custom = Store_Categorie_Custom_Input.value;

                                                if (Store_Categorie !== "Other") {
                                                    Store_Categorie_Custom_Input.value = "";
                                                    Store_Categorie_Custom = "";
                                                }

                                                fetch('/Role/Shop_Owner/Page/System_Settings/Update_Settings_Form_1', {
                                                    method: 'POST',
                                                    headers: {
                                                        'Content-Type': 'application/json',
                                                        'X-Requested-With': 'XMLHttpRequest'
                                                    },
                                                    body: JSON.stringify({
                                                        store_name: Store_Name,
                                                        store_description: Store_Description,
                                                        store_categorie: Store_Categorie,
                                                        store_categorie_custom: Store_Categorie_Custom
                                                    })
                                                })
                                                .then(response => response.json())
                                                .then(data => {
                                                    if (data.success) {
                                                        console.log('Setting updated successfully');
                                                        location.reload();
                                                    } else {
                                                        console.error('Failed to update setting:', data.error);
                                                    }
                                                })
                                                .catch(error => console.error('Error:', error));
                                            }

                                            function preventEnterKey(event) {
                                                if (event.key === 'Enter') {
                                                    event.preventDefault();
                                                }
                                            }

                                            Store_Name_Input.addEventListener('keydown', preventEnterKey);
                                            Store_Categorie_Select.addEventListener('keydown', preventEnterKey);
                                            Store_Categorie_Select.addEventListener('keydown', preventEnterKey);

                                            Store_Name_Input.addEventListener('change', updateSettings);
                                            Store_Categorie_Select.addEventListener('change', updateSettings);
                                            Store_Categorie_Custom_Input.addEventListener('change', updateSettings);
                                        });
                                    </script>
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">ส่วนช่วงเวลาเปิดทำการของร้านค้า</div>
                                <div class="card-body">

                                    <% if (settings_form_2_error) { %>
                                    <div class="alert alert-danger text-center" role="alert">
                                        <span><i class="fas fa-exclamation-triangle mr-2"></i><%= settings_form_2_error %>
                                    </div>
                                    <% } %>
                                    <% if (settings_form_2_success) { %>
                                    <div class="alert alert-success text-center" role="alert">
                                        <span><i class="fas fa-check-circle mr-2"></i><%= settings_form_2_success %>
                                    </div>
                                    <% } %>

                                    <form action="" class="needs-validation" novalidate method="POST">
                                        <!-- วันจันทร์ -->
                                        <div class="form-group row">
                                            <label for="day_open_1" class="col-sm-2 col-form-label required">วันเปิดทำการ วันจันทร์ :</label>
                                            <div class="col-sm-4">
                                                <select class="form-control form-control-lg" name="day_open_1" id="day_open_1" required>
                                                    <option <%= settings.day_open_1 === 'เปิดทำการ' ? 'selected' : '' %> value="เปิดทำการ">เปิดทำการ</option>
                                                    <option <%= settings.day_open_1 === 'ปิดทำการ' ? 'selected' : '' %> value="ปิดทำการ">ปิดทำการ</option>
                                                </select>
                                                <div class="valid-feedback">
                                                    เลือกวันเปิดทำการถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกวันเปิดทำการให้ถูกต้อง
                                                </div>
                                            </div>
                                            <label for="time_open_1" class="col-sm-1 col-form-label required">เวลาเปิด :</label>
                                            <div class="col-sm-2">
                                                <input type="time" class="form-control form-control-lg" name="time_open_1" id="time_open_1" value="<%= settings.time_open_1 %>" required autocomplete="off">
                                                <div class="valid-feedback">
                                                    เลือกเวลาเปิดถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกเวลาเปิดให้ถูกต้อง
                                                </div>
                                            </div>
                                            <label for="time_close_1" class="col-sm-1 col-form-label required">เวลาปิด :</label>
                                            <div class="col-sm-2">
                                                <input type="time" class="form-control form-control-lg" name="time_close_1" id="time_close_1" value="<%= settings.time_close_1 %>" required autocomplete="off">
                                                <div class="valid-feedback">
                                                    เลือกเวลาปิดถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกเวลาปิดให้ถูกต้อง
                                                </div>
                                            </div>
                                        </div>
                                        <!-- วันจันทร์ -->
                                        <!-- วันอังคาร -->
                                        <div class="form-group row">
                                            <label for="day_open_2" class="col-sm-2 col-form-label required">วันเปิดทำการ วันอังคาร :</label>
                                            <div class="col-sm-4">
                                                <select class="form-control form-control-lg" name="day_open_2" id="day_open_2" required>
                                                    <option <%= settings.day_open_2 === 'เปิดทำการ' ? 'selected' : '' %> value="เปิดทำการ">เปิดทำการ</option>
                                                    <option <%= settings.day_open_2 === 'ปิดทำการ' ? 'selected' : '' %> value="ปิดทำการ">ปิดทำการ</option>
                                                </select>
                                                <div class="valid-feedback">
                                                    เลือกวันเปิดทำการถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกวันเปิดทำการให้ถูกต้อง
                                                </div>
                                            </div>
                                            <label for="time_open_2" class="col-sm-1 col-form-label required">เวลาเปิด :</label>
                                            <div class="col-sm-2">
                                                <input type="time" class="form-control form-control-lg" name="time_open_2" id="time_open_2" value="<%= settings.time_open_2 %>" required autocomplete="off">
                                                <div class="valid-feedback">
                                                    เลือกเวลาเปิดถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกเวลาเปิดให้ถูกต้อง
                                                </div>
                                            </div>
                                            <label for="time_close_2" class="col-sm-1 col-form-label required">เวลาปิด :</label>
                                            <div class="col-sm-2">
                                                <input type="time" class="form-control form-control-lg" name="time_close_2" id="time_close_2" value="<%= settings.time_close_2 %>" required autocomplete="off">
                                                <div class="valid-feedback">
                                                    เลือกเวลาปิดถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกเวลาปิดให้ถูกต้อง
                                                </div>
                                            </div>
                                        </div>
                                        <!-- วันอังคาร -->
                                        <!-- วันพุธ -->
                                        <div class="form-group row">
                                            <label for="day_open_3" class="col-sm-2 col-form-label required">วันเปิดทำการ วันพุธ :</label>
                                            <div class="col-sm-4">
                                                <select class="form-control form-control-lg" name="day_open_3" id="day_open_3" required>
                                                    <option <%= settings.day_open_3 === 'เปิดทำการ' ? 'selected' : '' %> value="เปิดทำการ">เปิดทำการ</option>
                                                    <option <%= settings.day_open_3 === 'ปิดทำการ' ? 'selected' : '' %> value="ปิดทำการ">ปิดทำการ</option>
                                                </select>
                                                <div class="valid-feedback">
                                                    เลือกวันเปิดทำการถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกวันเปิดทำการให้ถูกต้อง
                                                </div>
                                            </div>
                                            <label for="time_open_3" class="col-sm-1 col-form-label required">เวลาเปิด :</label>
                                            <div class="col-sm-2">
                                                <input type="time" class="form-control form-control-lg" name="time_open_3" id="time_open_3" value="<%= settings.time_open_3 %>" required autocomplete="off">
                                                <div class="valid-feedback">
                                                    เลือกเวลาเปิดถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกเวลาเปิดให้ถูกต้อง
                                                </div>
                                            </div>
                                            <label for="time_close_3" class="col-sm-1 col-form-label required">เวลาปิด :</label>
                                            <div class="col-sm-2">
                                                <input type="time" class="form-control form-control-lg" name="time_close_3" id="time_close_3" value="<%= settings.time_close_3 %>" required autocomplete="off">
                                                <div class="valid-feedback">
                                                    เลือกเวลาปิดถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกเวลาปิดให้ถูกต้อง
                                                </div>
                                            </div>
                                        </div>
                                        <!-- วันพุธ -->
                                        <!-- วันพฤหัสบดี -->
                                        <div class="form-group row">
                                            <label for="day_open_4" class="col-sm-2 col-form-label required">วันเปิดทำการ วันพฤหัสบดี :</label>
                                            <div class="col-sm-4">
                                                <select class="form-control form-control-lg" name="day_open_4" id="day_open_4" required>
                                                    <option <%= settings.day_open_4 === 'เปิดทำการ' ? 'selected' : '' %> value="เปิดทำการ">เปิดทำการ</option>
                                                    <option <%= settings.day_open_4 === 'ปิดทำการ' ? 'selected' : '' %> value="ปิดทำการ">ปิดทำการ</option>
                                                </select>
                                                <div class="valid-feedback">
                                                    เลือกวันเปิดทำการถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกวันเปิดทำการให้ถูกต้อง
                                                </div>
                                            </div>
                                            <label for="time_open_4" class="col-sm-1 col-form-label required">เวลาเปิด :</label>
                                            <div class="col-sm-2">
                                                <input type="time" class="form-control form-control-lg" name="time_open_4" id="time_open_4" value="<%= settings.time_open_4 %>" required autocomplete="off">
                                                <div class="valid-feedback">
                                                    เลือกเวลาเปิดถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกเวลาเปิดให้ถูกต้อง
                                                </div>
                                            </div>
                                            <label for="time_close_4" class="col-sm-1 col-form-label required">เวลาปิด :</label>
                                            <div class="col-sm-2">
                                                <input type="time" class="form-control form-control-lg" name="time_close_4" id="time_close_4" value="<%= settings.time_close_4 %>" required autocomplete="off">
                                                <div class="valid-feedback">
                                                    เลือกเวลาปิดถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกเวลาปิดให้ถูกต้อง
                                                </div>
                                            </div>
                                        </div>
                                        <!-- วันพฤหัสบดี -->
                                        <!-- วันศุกร์ -->
                                        <div class="form-group row">
                                            <label for="day_open_5" class="col-sm-2 col-form-label required">วันเปิดทำการ วันศุกร์ :</label>
                                            <div class="col-sm-4">
                                                <select class="form-control form-control-lg" name="day_open_5" id="day_open_5" required>
                                                    <option <%= settings.day_open_5 === 'เปิดทำการ' ? 'selected' : '' %> value="เปิดทำการ">เปิดทำการ</option>
                                                    <option <%= settings.day_open_5 === 'ปิดทำการ' ? 'selected' : '' %> value="ปิดทำการ">ปิดทำการ</option>
                                                </select>
                                                <div class="valid-feedback">
                                                    เลือกวันเปิดทำการถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกวันเปิดทำการให้ถูกต้อง
                                                </div>
                                            </div>
                                            <label for="time_open_5" class="col-sm-1 col-form-label required">เวลาเปิด :</label>
                                            <div class="col-sm-2">
                                                <input type="time" class="form-control form-control-lg" name="time_open_5" id="time_open_5" value="<%= settings.time_open_5 %>" required autocomplete="off">
                                                <div class="valid-feedback">
                                                    เลือกเวลาเปิดถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกเวลาเปิดให้ถูกต้อง
                                                </div>
                                            </div>
                                            <label for="time_close_5" class="col-sm-1 col-form-label required">เวลาปิด :</label>
                                            <div class="col-sm-2">
                                                <input type="time" class="form-control form-control-lg" name="time_close_5" id="time_close_5" value="<%= settings.time_close_5 %>" required autocomplete="off">
                                                <div class="valid-feedback">
                                                    เลือกเวลาปิดถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกเวลาปิดให้ถูกต้อง
                                                </div>
                                            </div>
                                        </div>
                                        <!-- วันศุกร์ -->
                                        <!-- วันเสาร์ -->
                                        <div class="form-group row">
                                            <label for="day_open_6" class="col-sm-2 col-form-label required">วันเปิดทำการ วันเสาร์ :</label>
                                            <div class="col-sm-4">
                                                <select class="form-control form-control-lg" name="day_open_6" id="day_open_6" required>
                                                    <option <%= settings.day_open_6 === 'เปิดทำการ' ? 'selected' : '' %> value="เปิดทำการ">เปิดทำการ</option>
                                                    <option <%= settings.day_open_6 === 'ปิดทำการ' ? 'selected' : '' %> value="ปิดทำการ">ปิดทำการ</option>
                                                </select>
                                                <div class="valid-feedback">
                                                    เลือกวันเปิดทำการถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกวันเปิดทำการให้ถูกต้อง
                                                </div>
                                            </div>
                                            <label for="time_open_6" class="col-sm-1 col-form-label required">เวลาเปิด :</label>
                                            <div class="col-sm-2">
                                                <input type="time" class="form-control form-control-lg" name="time_open_6" id="time_open_6" value="<%= settings.time_open_6 %>" required autocomplete="off">
                                                <div class="valid-feedback">
                                                    เลือกเวลาเปิดถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกเวลาเปิดให้ถูกต้อง
                                                </div>
                                            </div>
                                            <label for="time_close_6" class="col-sm-1 col-form-label required">เวลาปิด :</label>
                                            <div class="col-sm-2">
                                                <input type="time" class="form-control form-control-lg" name="time_close_6" id="time_close_6" value="<%= settings.time_close_6 %>" required autocomplete="off">
                                                <div class="valid-feedback">
                                                    เลือกเวลาปิดถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกเวลาปิดให้ถูกต้อง
                                                </div>
                                            </div>
                                        </div>
                                        <!-- วันเสาร์ -->
                                        <!-- วันอาทิตย์ -->
                                        <div class="form-group row">
                                            <label for="day_open_7" class="col-sm-2 col-form-label required">วันเปิดทำการ วันอาทิตย์ :</label>
                                            <div class="col-sm-4">
                                                <select class="form-control form-control-lg" name="day_open_7" id="day_open_7" required>
                                                    <option <%= settings.day_open_7 === 'เปิดทำการ' ? 'selected' : '' %> value="เปิดทำการ">เปิดทำการ</option>
                                                    <option <%= settings.day_open_7 === 'ปิดทำการ' ? 'selected' : '' %> value="ปิดทำการ">ปิดทำการ</option>
                                                </select>
                                                <div class="valid-feedback">
                                                    เลือกวันเปิดทำการถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกวันเปิดทำการให้ถูกต้อง
                                                </div>
                                            </div>
                                            <label for="time_open_7" class="col-sm-1 col-form-label required">เวลาเปิด :</label>
                                            <div class="col-sm-2">
                                                <input type="time" class="form-control form-control-lg" name="time_open_7" id="time_open_7" value="<%= settings.time_open_7 %>" required autocomplete="off">
                                                <div class="valid-feedback">
                                                    เลือกเวลาเปิดถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกเวลาเปิดให้ถูกต้อง
                                                </div>
                                            </div>
                                            <label for="time_close_7" class="col-sm-1 col-form-label required">เวลาปิด :</label>
                                            <div class="col-sm-2">
                                                <input type="time" class="form-control form-control-lg" name="time_close_7" id="time_close_7" value="<%= settings.time_close_7 %>" required autocomplete="off">
                                                <div class="valid-feedback">
                                                    เลือกเวลาปิดถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกเวลาปิดให้ถูกต้อง
                                                </div>
                                            </div>
                                        </div>
                                        <!-- วันอาทิตย์ -->
                                    </form>
                                    <script>
                                        document.addEventListener('DOMContentLoaded', () => {
                                            // วันจันทร์
                                            const Day_Open_1_Select = document.getElementById('day_open_1');
                                            const Time_Open_1_Input = document.getElementById('time_open_1');
                                            const Time_Close_1_Input = document.getElementById('time_close_1');
                                            // วันอังคาร
                                            const Day_Open_2_Select = document.getElementById('day_open_2');
                                            const Time_Open_2_Input = document.getElementById('time_open_2');
                                            const Time_Close_2_Input = document.getElementById('time_close_2');
                                            // วันพุธ
                                            const Day_Open_3_Select = document.getElementById('day_open_3');
                                            const Time_Open_3_Input = document.getElementById('time_open_3');
                                            const Time_Close_3_Input = document.getElementById('time_close_3');
                                            // วันพฤหัสบดี
                                            const Day_Open_4_Select = document.getElementById('day_open_4');
                                            const Time_Open_4_Input = document.getElementById('time_open_4');
                                            const Time_Close_4_Input = document.getElementById('time_close_4');
                                            // วันศุกร์
                                            const Day_Open_5_Select = document.getElementById('day_open_5');
                                            const Time_Open_5_Input = document.getElementById('time_open_5');
                                            const Time_Close_5_Input = document.getElementById('time_close_5');
                                            // วันเสาร์
                                            const Day_Open_6_Select = document.getElementById('day_open_6');
                                            const Time_Open_6_Input = document.getElementById('time_open_6');
                                            const Time_Close_6_Input = document.getElementById('time_close_6');
                                            // วันอาทิตย์
                                            const Day_Open_7_Select = document.getElementById('day_open_7');
                                            const Time_Open_7_Input = document.getElementById('time_open_7');
                                            const Time_Close_7_Input = document.getElementById('time_close_7');
                                    
                                            function updateSettings() {
                                                // วันจันทร์
                                                const Day_Open_1 = Day_Open_1_Select.value;
                                                const Time_Open_1 = Time_Open_1_Input.value;
                                                const Time_Close_1 = Time_Close_1_Input.value;
                                                // วันอังคาร
                                                const Day_Open_2 = Day_Open_2_Select.value;
                                                const Time_Open_2 = Time_Open_2_Input.value;
                                                const Time_Close_2 = Time_Close_2_Input.value;
                                                // วันพุธ
                                                const Day_Open_3 = Day_Open_3_Select.value;
                                                const Time_Open_3 = Time_Open_3_Input.value;
                                                const Time_Close_3 = Time_Close_3_Input.value;
                                                // วันพฤหัสบดี
                                                const Day_Open_4 = Day_Open_4_Select.value;
                                                const Time_Open_4 = Time_Open_4_Input.value;
                                                const Time_Close_4 = Time_Close_4_Input.value;
                                                // วันศุกร์
                                                const Day_Open_5 = Day_Open_5_Select.value;
                                                const Time_Open_5 = Time_Open_5_Input.value;
                                                const Time_Close_5 = Time_Close_5_Input.value;
                                                // วันเสาร์
                                                const Day_Open_6 = Day_Open_6_Select.value;
                                                const Time_Open_6 = Time_Open_6_Input.value;
                                                const Time_Close_6 = Time_Close_6_Input.value;
                                                // วันอาทิตย์
                                                const Day_Open_7 = Day_Open_7_Select.value;
                                                const Time_Open_7 = Time_Open_7_Input.value;
                                                const Time_Close_7 = Time_Close_7_Input.value;
                                    
                                                fetch('/Role/Shop_Owner/Page/System_Settings/Update_Settings_Form_2', {
                                                    method: 'POST',
                                                    headers: {
                                                        'Content-Type': 'application/json',
                                                        'X-Requested-With': 'XMLHttpRequest'
                                                    },
                                                    body: JSON.stringify({
                                                        // วันจันทร์
                                                        day_open_1: Day_Open_1,
                                                        time_open_1: Time_Open_1,
                                                        time_close_1: Time_Close_1,
                                                        // วันอังคาร
                                                        day_open_2: Day_Open_2,
                                                        time_open_2: Time_Open_2,
                                                        time_close_2: Time_Close_2,
                                                        // วันพุธ
                                                        day_open_3: Day_Open_3,
                                                        time_open_3: Time_Open_3,
                                                        time_close_3: Time_Close_3,
                                                        // วันพฤหัสบดี
                                                        day_open_4: Day_Open_4,
                                                        time_open_4: Time_Open_4,
                                                        time_close_4: Time_Close_4,
                                                        // วันศุกร์
                                                        day_open_5: Day_Open_5,
                                                        time_open_5: Time_Open_5,
                                                        time_close_5: Time_Close_5,
                                                        // วันเสาร์
                                                        day_open_6: Day_Open_6,
                                                        time_open_6: Time_Open_6,
                                                        time_close_6: Time_Close_6,
                                                        // วันอาทิตย์
                                                        day_open_7: Day_Open_7,
                                                        time_open_7: Time_Open_7,
                                                        time_close_7: Time_Close_7
                                                    })
                                                })
                                                .then(response => response.json())
                                                .then(data => {
                                                    if (data.success) {
                                                        console.log('Setting updated successfully');
                                                        // Reload the page
                                                        location.reload();
                                                    } else {
                                                        console.error('Failed to update setting');
                                                    }
                                                })
                                                .catch(error => console.error('Error:', error));
                                            }
                                    
                                            function preventEnterKey(event) {
                                                if (event.key === 'Enter') {
                                                    event.preventDefault();
                                                }
                                            }
                                            
                                            // ใช้ change event เพื่อ update
                                            // วันจันทร์
                                            Day_Open_1_Select.addEventListener('change', updateSettings);
                                            Time_Open_1_Input.addEventListener('change', updateSettings);
                                            Time_Close_1_Input.addEventListener('change', updateSettings);
                                            // วันอังคาร
                                            Day_Open_2_Select.addEventListener('change', updateSettings);
                                            Time_Open_2_Input.addEventListener('change', updateSettings);
                                            Time_Close_2_Input.addEventListener('change', updateSettings);
                                            // วันพุธ
                                            Day_Open_3_Select.addEventListener('change', updateSettings);
                                            Time_Open_3_Input.addEventListener('change', updateSettings);
                                            Time_Close_3_Input.addEventListener('change', updateSettings);
                                            // วันพฤหัสบดี
                                            Day_Open_4_Select.addEventListener('change', updateSettings);
                                            Time_Open_4_Input.addEventListener('change', updateSettings);
                                            Time_Close_4_Input.addEventListener('change', updateSettings);
                                            // วันศุกร์
                                            Day_Open_5_Select.addEventListener('change', updateSettings);
                                            Time_Open_5_Input.addEventListener('change', updateSettings);
                                            Time_Close_5_Input.addEventListener('change', updateSettings);
                                            // วันเสาร์
                                            Day_Open_6_Select.addEventListener('change', updateSettings);
                                            Time_Open_6_Input.addEventListener('change', updateSettings);
                                            Time_Close_6_Input.addEventListener('change', updateSettings);
                                            // วันอาทิตย์
                                            Day_Open_7_Select.addEventListener('change', updateSettings);
                                            Time_Open_7_Input.addEventListener('change', updateSettings);
                                            Time_Close_7_Input.addEventListener('change', updateSettings);
                                        });
                                    </script>
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">ส่วนแผนที่ร้านค้า</div>
                                <div class="card-body">

                                    <% if (settings_form_3_error) { %>
                                    <div class="alert alert-danger text-center" role="alert">
                                        <span><i class="fas fa-exclamation-triangle mr-2"></i><%= settings_form_3_error %>
                                    </div>
                                    <% } %>
                                    <% if (settings_form_3_success) { %>
                                    <div class="alert alert-success text-center" role="alert">
                                        <span><i class="fas fa-check-circle mr-2"></i><%= settings_form_3_success %>
                                    </div>
                                    <% } %>

                                    <form action="" class="needs-validation" novalidate method="POST">
                                        <div class="form-group row">
                                            <label for="map_iframe_api" class="col-sm-2 col-form-label required">วาง Iframe จาก Google Map :</label>
                                            <div class="col-sm-10">
                                                <input type="text" class="form-control form-control-lg mb-2" name="map_iframe_api" id="map_iframe_api" placeholder="คัดลอกและวางฝังแผนที่จาก Iframe Google Map" value="<%= settings.map_iframe_api %>" required autocomplete="off">
                                                <span class="text-muted">(ระบบจะตัดส่วน <b>"<u>iframe</u>"</b> ที่ไม่เกี่ยวข้องให้เหลือเฉพาะข้อมูลใน <b>"<u>src</u>"</b> ให้โดยอัติโนมัติ)</span>
                                                <div class="valid-feedback">
                                                    กรอกฝังแผนที่จาก Google Map ถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณากรอกฝังแผนที่จาก Google Map ให้ถูกต้อง
                                                </div>
                                            </div>
                                        </div>
                                        <script>
                                            // script ตัดข้อมูลที่ไม่เกี่ยวข้อง เอาเฉพาะ url google map api ใน src
                                            document.getElementById('map_iframe_api').addEventListener('input', updateIframeSrc);
                                            document.getElementById('map_iframe_api').addEventListener('paste', function(e) {
                                                setTimeout(updateIframeSrc.bind(this), 0);
                                            });
                                        
                                            function updateIframeSrc() {
                                                let inputValue = this.value;
                                                let srcPattern = /src="([^"]*)"/;
                                                let match = inputValue.match(srcPattern);
                                                
                                                if (match) {
                                                    this.value = match[1];
                                                }
                                            }
                                        </script>                                        
                                        <div class="form-group row">
                                            <label for="map_iframe_api_preview" class="col-sm-2 col-form-label">Preview Iframe จาก Google Map :</label>
                                            <div class="col-sm-10">
                                                <iframe src="<%= settings.map_iframe_api %>" width="100%" height="450" style="border: 1px solid #e7e7e7;"></iframe>
                                            </div>
                                        </div>
                                    </form>
                                    <script>
                                        document.addEventListener('DOMContentLoaded', () => {
                                            const Map_Iframe_Api_Input = document.getElementById('map_iframe_api');
                                    
                                            function updateSettings() {
                                                const Map_Iframe_Api = Map_Iframe_Api_Input.value;
                                    
                                                fetch('/Role/Shop_Owner/Page/System_Settings/Update_Settings_Form_3', {
                                                    method: 'POST',
                                                    headers: {
                                                        'Content-Type': 'application/json',
                                                        'X-Requested-With': 'XMLHttpRequest'
                                                    },
                                                    body: JSON.stringify({
                                                        map_iframe_api: Map_Iframe_Api,
                                                    })
                                                })
                                                .then(response => response.json())
                                                .then(data => {
                                                    if (data.success) {
                                                        console.log('Setting updated successfully');
                                                        // Reload the page
                                                        location.reload();
                                                    } else {
                                                        console.error('Failed to update setting');
                                                    }
                                                })
                                                .catch(error => console.error('Error:', error));
                                            }
                                    
                                            function preventEnterKey(event) {
                                                if (event.key === 'Enter') {
                                                    event.preventDefault();
                                                }
                                            }

                                            // ป้องกันการกดปุ่ม Enter
                                            Map_Iframe_Api_Input.addEventListener('keydown', preventEnterKey);

                                            // ใช้ change event เพื่อ update
                                            Map_Iframe_Api_Input.addEventListener('change', updateSettings);
                                        });
                                    </script>
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">ส่วนข้อมูลสมาชิกร้านค้า</div>
                                <div class="card-body">

                                    <% if (settings_form_4_error) { %>
                                    <div class="alert alert-danger text-center" role="alert">
                                        <span><i class="fas fa-exclamation-triangle mr-2"></i><%= settings_form_4_error %>
                                    </div>
                                    <% } %>
                                    <% if (settings_form_4_success) { %>
                                    <div class="alert alert-success text-center" role="alert">
                                        <span><i class="fas fa-check-circle mr-2"></i><%= settings_form_4_success %>
                                    </div>
                                    <% } %>

                                    <form action="" class="needs-validation" novalidate method="POST">
                                        <div class="form-group row">
                                            <label for="customer_discount" class="col-sm-2 col-form-label required">ส่วนลดสำหรับลูกค้าสมาชิก :</label>
                                            <div class="col-sm-10">
                                                <select class="form-control form-control-lg customer_discount" name="customer_discount" id="customer_discount" required>
                                                    <option value="" selected disabled>เลือกรูปแบบส่วนลดลูกค้าสมาชิก</option>
                                                    <option <%= settings.customer_discount === '1' ? 'selected' : '' %> value="1">ส่วนลดลูกค้าสมาชิก 1%</option>
                                                    <option <%= settings.customer_discount === '1.5' ? 'selected' : '' %> value="1.5">ส่วนลดลูกค้าสมาชิก 1.5%</option>
                                                    <option <%= settings.customer_discount === '2' ? 'selected' : '' %> value="2">ส่วนลดลูกค้าสมาชิก 2%</option>
                                                    <option <%= settings.customer_discount === '2.5' ? 'selected' : '' %> value="2.5">ส่วนลดลูกค้าสมาชิก 2.5%</option>
                                                    <option <%= settings.customer_discount === '3' ? 'selected' : '' %> value="3">ส่วนลดลูกค้าสมาชิก 3%</option>
                                                    <option <%= settings.customer_discount === '3.5' ? 'selected' : '' %> value="3.5">ส่วนลดลูกค้าสมาชิก 3.5%</option>
                                                    <option <%= settings.customer_discount === '4' ? 'selected' : '' %> value="4">ส่วนลดลูกค้าสมาชิก 4%</option>
                                                    <option <%= settings.customer_discount === '4.5' ? 'selected' : '' %> value="4.5">ส่วนลดลูกค้าสมาชิก 4.5%</option>
                                                    <option <%= settings.customer_discount === '5' ? 'selected' : '' %> value="5">ส่วนลดลูกค้าสมาชิก 5%</option>
                                                    <option <%= settings.customer_discount === 'Other' ? 'selected' : '' %> value="Other">อื่น ๆ กำหนดเอง</option>
                                                    <option <%= settings.customer_discount === '0' ? 'selected' : '' %> value="0">ปิดระบบส่วนลดลูกค้าสมาชิก</option>
                                                </select>
                                                <div class="valid-feedback">
                                                    เลือกส่วนลดสำหรับสมาชิกถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณาเลือกส่วนลดสำหรับสมาชิกให้ถูกต้อง
                                                </div>
                                                <div class="btn btn-custom-two btn-lg btn-block mt-3" data-toggle="collapse" data-target="#HelpInformationDiscount" aria-expanded="false" aria-controls="HelpInformation"><i class="fas fa-info-circle mr-2"></i>คำแนะนำส่วนลดสำหรับลูกค้าสมาชิก (คลิ้ก)</div>
                                                <div class="collapse mt-3" id="HelpInformationDiscount">
                                                    <div class="card card-body">
                                                        <ul class="pl-3 pr-3 pt-0 pb-0 m-0">
                                                            <li>
                                                                <b>ส่วนลดลูกค้าสมาชิก</b><br>
                                                                <span>ส่วนลดลูกค้าสมาชิก 1% - 5% คือค่าพิ้นฐาน สามารถกำหนดเองได้</span>
                                                            </li>
                                                            <li>
                                                                <b>อื่น ๆ กำหนดเอง</b><br>
                                                                <span>กำหนดส่วนลดด้วยตนเอง</span>
                                                            </li>
                                                            <li>
                                                                <b>ปิดระบบส่วนลดลูกค้าสมาชิก</b><br>
                                                                <span>ระบบส่วนลดสำหรับลูกค้าสมาชิกถูกปิดใช้งาน</span>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group row <% if (settings.customer_discount !== 'Other') { %> d-none <% } %>">
                                            <label for="customer_discount_custom" class="col-sm-2 col-form-label required">อื่น ๆ กำหนดส่วนลดเอง :</label>
                                            <div class="col-sm-10">
                                                <input type="text" class="form-control form-control-lg customer_discount_custom" name="customer_discount_custom" id="customer_discount_custom" placeholder="กำหนดส่วนลดสำหรับสมาชิกเอง" value="<%= settings.customer_discount_custom %>" required autocomplete="off">
                                                <div class="valid-feedback">
                                                    กรอกส่วนลดสำหรับสมาชิกถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณากรอกส่วนลดสำหรับสมาชิกให้ถูกต้อง
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="customer_discount_preview" class="col-sm-2 col-form-label align-self-center">Preview ส่วนลดสำหรับสมาชิก :</label>
                                            <div class="col-sm-10">
                                                <div class="list-group">
                                                    <div class="list-group-item">
                                                        <% if (settings.customer_discount === "0") { %>
                                                            ระบบส่วนลดสำหรับลูกค้าสมาชิกถูกปิดใช้งาน หากต้องการเปิดใช้งานให้ใส่จำนวนตัวเลขร้อยละ
                                                        <% } else { %>
                                                            <% if (settings.customer_discount === "Other") { %>
                                                                สำหรับลูกค้าสมาชิกจะได้รับส่วนลด <%= settings.customer_discount_custom %>% แต่ละออเดอร์
                                                            <% } else { %>
                                                                สำหรับลูกค้าสมาชิกจะได้รับส่วนลด <%= settings.customer_discount %>% แต่ละออเดอร์
                                                            <% } %>  
                                                        <% } %>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                    <script>
                                        document.addEventListener('DOMContentLoaded', () => {
                                            const Customer_Discount_Input = document.getElementById('customer_discount');
                                            const Customer_Discount_Custom_Input = document.getElementById('customer_discount_custom');
                                    
                                            function updateSettings() {
                                                let Customer_Discount = Customer_Discount_Input.value;
                                                let Customer_Discount_Custom = Customer_Discount_Custom_Input.value;

                                                if (Customer_Discount !== "Other") {
                                                    Customer_Discount_Custom_Input.value = "1";
                                                    Customer_Discount_Custom = "1";
                                                }

                                                fetch('/Role/Shop_Owner/Page/System_Settings/Update_Settings_Form_4', {
                                                    method: 'POST',
                                                    headers: {
                                                        'Content-Type': 'application/json',
                                                        'X-Requested-With': 'XMLHttpRequest'
                                                    },
                                                    body: JSON.stringify({
                                                        customer_discount: Customer_Discount,
                                                        customer_discount_custom: Customer_Discount_Custom,
                                                    })
                                                })
                                                .then(response => response.json())
                                                .then(data => {
                                                    if (data.success) {
                                                        console.log('Setting updated successfully');
                                                        // Reload the page
                                                        location.reload();
                                                    } else {
                                                        console.error('Failed to update setting');
                                                    }
                                                })
                                                .catch(error => console.error('Error:', error));
                                            }
                                    
                                            function preventEnterKey(event) {
                                                if (event.key === 'Enter') {
                                                    event.preventDefault();
                                                }
                                            }

                                            // ป้องกันการกดปุ่ม Enter
                                            Customer_Discount_Input.addEventListener('keydown', preventEnterKey);
                                            Customer_Discount_Custom_Input.addEventListener('keydown', preventEnterKey);

                                            // ใช้ change event เพื่อ update
                                            Customer_Discount_Input.addEventListener('change', updateSettings);
                                            Customer_Discount_Custom_Input.addEventListener('change', updateSettings);
                                        });
                                    </script>
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">ส่วนนโยบายความเป็นส่วนตัว ข้อกำหนดและเงื่อนไข นโยบายการใช้คุกกี้</div>
                                <div class="card-body">

                                    <% if (settings_form_5_error) { %>
                                    <div class="alert alert-danger text-center" role="alert">
                                        <span><i class="fas fa-exclamation-triangle mr-2"></i><%= settings_form_5_error %>
                                    </div>
                                    <% } %>
                                    <% if (settings_form_5_success) { %>
                                    <div class="alert alert-success text-center" role="alert">
                                        <span><i class="fas fa-check-circle mr-2"></i><%= settings_form_5_success %>
                                    </div>
                                    <% } %>

                                    <form action="" class="needs-validation" novalidate method="POST">
                                        <div class="form-group row">
                                            <label for="privacy_policy" class="col-sm-2 col-form-label required">นโยบายความเป็นส่วนตัว</label>
                                            <div class="col-sm-10">
                                                <textarea class="form-control form-control-lg summernote-txt-multiple" name="privacy_policy" id="privacy_policy" rows="5" placeholder="นโยบายความเป็นส่วนตัว" required autocomplete="off"><%= settings.privacy_policy %></textarea>
                                                <div class="valid-feedback">
                                                    กรอกนโยบายความเป็นส่วนตัวถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณากรอกนโยบายความเป็นส่วนตัวให้ถูกต้อง
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="terms_and_conditions" class="col-sm-2 col-form-label required">ข้อกำหนดและเงื่อนไขการใช้งาน</label>
                                            <div class="col-sm-10">
                                                <textarea class="form-control form-control-lg summernote-txt-multiple" name="terms_and_conditions" id="terms_and_conditions" rows="5" placeholder="ข้อกำหนดและเงื่อนไขการใช้งาน" required autocomplete="off"><%= settings.terms_and_conditions %></textarea>
                                                <div class="valid-feedback">
                                                    กรอกข้อกำหนดและเงื่อนไขการใช้งานถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณากรอกข้อกำหนดและเงื่อนไขการใช้งานให้ถูกต้อง
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="cookie" class="col-sm-2 col-form-label required">นโยบายการใช้คุกกี้</label>
                                            <div class="col-sm-10">
                                                <textarea class="form-control form-control-lg summernote-txt-multiple" name="cookie" id="cookie" rows="5" placeholder="นโยบายการใช้คุกกี้" required autocomplete="off"><%= settings.cookie %></textarea>
                                                <div class="valid-feedback">
                                                    กรอกนโยบายการใช้คุกกี้ถูกต้อง
                                                </div>
                                                <div class="invalid-feedback">
                                                    กรุณากรอกนโยบายการใช้คุกกี้ให้ถูกต้อง
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                    <script>
                                        document.addEventListener('DOMContentLoaded', () => {
                                            var ConfirmButton = function(context) {
                                                var ui = $.summernote.ui;
                                                var button = ui.button({
                                                    contents: '<i class="fas fa-save mr-1"></i>บันทึกข้อมูล',
                                                    tooltip: 'Save to Database',
                                                    click: function() {
                                                        updateSettings();
                                                    }
                                                });
                                                return button.render();
                                            };
                                    
                                            $('.summernote-txt-multiple').summernote({
                                                disableDragAndDrop: true,
                                                inheritPlaceholder: true,
                                                tabsize: 2,
                                                height: 300,
                                                fontNames: ['Bai Jamjuree'],
                                                fontNamesIgnoreCheck: ['Bai Jamjuree'],
                                                toolbar: [
                                                    ['style', ['style']],
                                                    ['font', ['bold', 'italic', 'underline', 'strikethrough', 'clear']],
                                                    ['color', ['color']],
                                                    ['para', ['ul', 'ol', 'paragraph', 'height']],
                                                    ['insert', ['link', 'hr']],
                                                    ['view_and_save', ['fullscreen', 'codeview', 'undo', 'redo', 'confirm']]
                                                ],
                                                buttons: {
                                                    confirm: ConfirmButton
                                                },
                                                popover: {
                                                    link: [
                                                        ['link', ['linkDialogShow', 'unlink']]
                                                    ]
                                                }
                                            });
                                    
                                            function updateSettings() {
                                                const privacyPolicy = $('#privacy_policy').summernote('code');
                                                const termsAndConditions = $('#terms_and_conditions').summernote('code');
                                                const cookiePolicy = $('#cookie').summernote('code');
                                    
                                                fetch('/Role/Shop_Owner/Page/System_Settings/Update_Settings_Form_5', {
                                                    method: 'POST',
                                                    headers: {
                                                        'Content-Type': 'application/json',
                                                        'X-Requested-With': 'XMLHttpRequest'
                                                    },
                                                    body: JSON.stringify({
                                                        privacy_policy: privacyPolicy,
                                                        terms_and_conditions: termsAndConditions,
                                                        cookie: cookiePolicy,
                                                    })
                                                })
                                                .then(response => response.json())
                                                .then(data => {
                                                    if (data.success) {
                                                        console.log('Setting updated successfully');
                                                        // Reload the page
                                                        location.reload();
                                                    } else {
                                                        console.error('Failed to update setting');
                                                    }
                                                })
                                                .catch(error => console.error('Error:', error));
                                            }
                                    
                                            function preventEnterKey(event) {
                                                if (event.key === 'Enter') {
                                                    event.preventDefault();
                                                }
                                            }
                                    
                                            // ป้องกันการกดปุ่ม Enter
                                            $('#privacy_policy, #terms_and_conditions, #cookie').on('keydown', preventEnterKey);
                                        });
                                    </script>                                                                      
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">ข้อมูลเซิร์ฟเวอร์</div>
                                <div class="card-body">

                                    <div class="form-group row">
                                        <label for="client_information" class="col-sm-2 col-form-label">ข้อมูลผู้ใช้ :</label>
                                        <div class="col-sm-10">
                                            <ul class="list-group">
                                                <li class="list-group-item">
                                                    <div class="row">
                                                        <div class="col">
                                                            <b>ไอพีของเครื่องผู้ใช้งาน :</b>
                                                        </div>
                                                        <div class="col">
                                                            <%= clientIp %>
                                                        </div>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <label for="server_information" class="col-sm-2 col-form-label">ข้อมูลเซิร์ฟเวอร์ :</label>
                                        <div class="col-sm-10">
                                            <ul class="list-group">
                                                <li class="list-group-item">
                                                    <div class="row">
                                                        <div class="col">
                                                            <b>ไอพีของเครื่องเซิร์ฟเวอร์ :</b>
                                                        </div>
                                                        <div class="col">
                                                            <%= ipAddress %>
                                                        </div>
                                                    </div>
                                                </li>
                                                <li class="list-group-item">
                                                    <div class="row">
                                                        <div class="col">
                                                            <b>ชื่อเครื่องของเซิร์ฟเวอร์ :</b>
                                                        </div>
                                                        <div class="col">
                                                            <%= hostname %>
                                                        </div>
                                                    </div>
                                                </li>
                                                <li class="list-group-item">
                                                    <div class="row">
                                                        <div class="col">
                                                            <b>แพลตฟอร์มของระบบปฏิบัติการ :</b>
                                                        </div>
                                                        <div class="col">
                                                            <%= platform %>
                                                        </div>
                                                    </div>
                                                </li>
                                                <li class="list-group-item">
                                                    <div class="row">
                                                        <div class="col">
                                                            <b>สถาปัตยกรรมของระบบปฏิบัติการ :</b>
                                                        </div>
                                                        <div class="col">
                                                            <%= architecture %>
                                                        </div>
                                                    </div>
                                                </li>
                                                <li class="list-group-item">
                                                    <div class="row">
                                                        <div class="col">
                                                            <b>เวอร์ชันของระบบปฏิบัติการ :</b>
                                                        </div>
                                                        <div class="col">
                                                            <%= release %>
                                                        </div>
                                                    </div>
                                                </li>
                                                <li class="list-group-item">
                                                    <div class="row">
                                                        <div class="col">
                                                            <b>ชนิดของระบบปฏิบัติการ :</b>
                                                        </div>
                                                        <div class="col">
                                                            <%= type %>
                                                        </div>
                                                    </div>
                                                </li>
                                                <li class="list-group-item">
                                                    <div class="row">
                                                        <div class="col">
                                                            <b>ชื่อและเวอร์ชันของระบบปฏิบัติการ :</b>
                                                        </div>
                                                        <div class="col">
                                                            <%= version %>
                                                        </div>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                        
                    </div>
                </div>
            </section>
            <!-- Main content End -->
        </div>        
        <!-- Content Wrapper. Contains page content End -->

        <!-- Footer -->
        <%- include('../../Include/Footer.ejs') %>
        <!-- Footer End -->

    </div>
    <!-- Wrapper End -->

    <!-- Javascript -->
    <%- include('../../Include/Javascript.ejs') %>
    <!-- Javascript End -->
</body>
</html>